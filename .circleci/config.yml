version: 2.1
jobs:
  haskell-build:
    working_directory: /root/CurryMud
    docker:
      - image: haskell:8
    steps:
      - checkout 
      - run: |
          apt update
          apt install -y libpcre3 libpcre3-dev
          stack setup
          stack build
          stack install

      - store_artifacts:
          path: /root/local/bin/curry
          destination: curry

      - store_artifacts:
          path: /root/CurryMud
          destination: CurryMud
         
workflows:
  build-test-deploy:
    jobs:
      - haskell-build
